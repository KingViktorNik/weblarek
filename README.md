# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/main.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# Интернет-магазин «Web-Larёk»
«Web-Larёk» — это интернет-магазин с товарами для веб-разработчиков, где пользователи могут просматривать товары, добавлять их в корзину и оформлять заказы. Сайт предоставляет удобный интерфейс с модальными окнами для просмотра деталей товаров, управления корзиной и выбора способа оплаты, обеспечивая полный цикл покупки с отправкой заказов на сервер.

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP (Model-View-Presenter), которая обеспечивает четкое разделение ответственности между классами слоев Model и View. Каждый слой несет свой смысл и ответственность:

Model - слой данных, отвечает за хранение и изменение данных.  
View - слой представления, отвечает за отображение данных на странице.  
Presenter - презентер содержит основную логику приложения и  отвечает за связь представления и данных.

Взаимодействие между классами обеспечивается использованием событийно-ориентированного подхода. Модели и Представления генерируют события при изменении данных или взаимодействии пользователя с приложением, а Презентер обрабатывает эти события используя методы как Моделей, так и Представлений.

### Базовый код

#### Класс Component
Является базовым классом для всех компонентов интерфейса.
Класс является дженериком и принимает в переменной `T` тип данных, которые могут быть переданы в метод `render` для отображения.

Конструктор:  
  - `constructor(container: HTMLElement)` - принимает ссылку на DOM элемент за отображение, которого он отвечает.

Поля класса:  
  - `container: HTMLElement` - поле для хранения корневого DOM элемента компонента.

Методы класса:  
  - `render(data?: Partial<T>): HTMLElement` - Главный метод класса. Он принимает данные, которые необходимо отобразить в интерфейсе, записывает эти данные в поля класса и возвращает ссылку на DOM-элемент. Предполагается, что в классах, которые будут наследоваться от `Component` будут реализованы сеттеры для полей с данными, которые будут вызываться в момент вызова `render` и записывать данные в необходимые DOM элементы.  
  - `setImage(element: HTMLImageElement, src: string, alt?: string): void` - утилитарный метод для модификации DOM-элементов `<img>`


#### Класс Api
Содержит в себе базовую логику отправки запросов.

Конструктор:  
  - `constructor(baseUrl: string, options: RequestInit = {})` - В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.

Поля класса:  
  - `baseUrl: string` - базовый адрес сервера  
  - `options: RequestInit` - объект с заголовками, которые будут использованы для запросов.

Методы:
  - `get(uri: string): Promise<object>` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер  
  - `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.  
  - `handleResponse(response: Response): Promise<object>` - защищенный метод проверяющий ответ сервера на корректность и возвращающий объект с данными полученный от сервера или отклоненный промис, в случае некорректных данных.

#### Класс EventEmitter
Брокер событий реализует паттерн "Наблюдатель", позволяющий отправлять события и подписываться на события, происходящие в системе. Класс используется для связи слоя данных и представления.

Конструктор класса не принимает параметров.

Поля класса:  
  - `_events: Map<string | RegExp, Set<Function>>)` -  хранит коллекцию подписок на события. Ключи коллекции - названия событий или регулярное выражение, значения - коллекция функций обработчиков, которые будут вызваны при срабатывании события.

Методы класса:  
  - `on<T extends object>(event: EventName, callback: (data: T) => void): void` - подписка на событие, принимает название события и функцию обработчик.  
  - `emit<T extends object>(event: string, data?: T): void` - инициализация события. При вызове события в метод передается название события и объект с данными, который будет использован как аргумент для вызова обработчика.  
  - `trigger<T extends object>(event: string, context?: Partial<T>): (data: T) => void` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие с передачей в него данных из второго параметра.

## Данные
### Типы и интерфейс 
#### ApiPostMethods
##### Тип: 
  объединение ('POST' | 'PUT' | 'DELETE')
##### Назначение: 
  перечисление допустимых HTTP‑методов для POST‑запросов.

#### IApi
##### Интерфейс: 
  базовый API для взаимодействия с сервером.
##### Методы:
  - `get<T extends object>(uri: string): Promise<T>` — GET‑запрос.
  - `post<T extends object>(uri: string, data: object, method?: ApiPostMethods): Promise<T>` — POST‑запрос с указанием метода.

#### IProduct
Итерфейс `IProduct` описывает структуру товара в каталоге. предназначен для хранения полной информации о товаре. Гарантирует единообразие структуры данных при получении с сервера, хранении и передаче между компонентами.
##### Интерфейс:
  описание товара в каталоге.
##### Поля:
  - `id: string` — Уникальный идентификатор товара. Используется для однозначной идентификации в системе, поиска и связывания с другими сущностями.
  - `title: string` — Краткое наименование товара. Отображается в списках товаров, карточках, результатах поиска и других интерфейсных элементах.
  - `description: string` — Подробное текстовое описание товара, включающее характеристики, особенности, технические параметры и другую значимую информацию для покупателя.
  - `image: string` — URL‑адрес изображения товара. Может быть относительным или абсолютным путём к файлу изображения.
  - `category: string` — Название категории, к которой принадлежит товар. Используется для группировки товаров и навигации в каталоге.
  - `price: number | null` — Текущая цена товара в числовом формате. Может принимать значение null, если цена временно недоступна или не определена.

#### TPayment
##### Тип:
  объединение ('online' | 'cash' | '')
##### Назначение: 
  допустимые способы оплаты.

#### ICustomer
##### Интерфейс:
  данные покупателя.
##### Поля:
  - `payment: TPayment` — способ оплаты;
  - `email: string` — email;
  - `phone: string` — телефон;
  - `address: string` — адрес доставки.

#### IOrderRequest
##### Интерфейс:
  запрос на оформление заказа (расширяет ICustomer).
##### Дополнительные поля:
  - `total: number` — итоговая сумма;
  - `items: string[]` — массив ID товаров.

#### ICardActions
##### Интерфейс:
  действия для карточки товара.
##### Метод:
  - `onClick(): void` — обработчик клика.

#### ISubmitAndGetIdTotal
##### Интерфейс
  Интерфейс ответа сервера после отправки заказа. Возвращается после успешного создания заказа.
##### Поля:
  - `id: string` - уникальный идентификатор заказа
  - `total: number` - итоговая сумма заказа (дублирует переданное значение)

### Модели данных
#### Класс ProductCatalog
Класс `ProductCatalog` отвечает за хранение и управление каталогом товаров. Содержит полный список доступных товаров и текущий выбранный товар для детального просмотра.

Конструктор:
  - `constructor(private events: IEvents)` - `events: IEvents` — система событий приложения. Инициализирует свойство `events`

Поля класса:  
  - `productList: IProduct[]` — Предназначен для хранения скписка товара.
  - `selectedProduct: IProduct | null`— Текущий выбранный товар для отображения в модальном окне (может быть null, если товар не выбран).
  - `events: IEvents` — Экземпляр системы событий для эмита событий;

Методы класса:  
  - `setProductList(products: IProduct[]): void` — Сохраняет переданный массив товаров в поле products.
  - `getProductList(): IProduct[]` — Возвращает полный список товаров из каталога. Возвращает массив товаров IProduct[].
  - `getProductById(id: string): IProduct | undefined` — Находит и возвращает товар по его уникальному идентификатору. Параметр id (string) — идентификатор товара. Возвращает товар типа IProduct или undefined, если товар не найден.
  - `setSelectedProduct(product: IProduct): void` — Сохраняет переданный товар в поле selectedProduct для детального отображения. Параметр product (IProduct) — выбранный товар.
  - `getSelectedProduct(): IProduct | null` — Возвращает товар, выбранный для подробного просмотра. Возвращает текущий выбранный товар (IProduct) или null.

#### Класс ShoppingCart
Класс `ShoppingCart` отвечает за управление корзиной покупок. Хранит список товаров, выбранных пользователем для покупки, и предоставляет методы для работы с корзиной.

Конструктор класса не принимает параметров.

Поля класса:  
  - `productList: IProduct[]` — Массив товаров, добавленных в корзину.

Методы класса:  
  - `getList(): IProduct[]` — Возвращает все товары(IProduct[]), находящиеся в корзине.
  - `add(product: IProduct): void` — Добавляет переданный товар в массив items. Если товар уже есть в корзине, не добавляет дубликат. Параметр product (IProduct) — товар для добавления.
  - `remove(product: IProduct): void` — Удаляет переданный товар из массива items по идентификатору. Параметр product (IProduct) — товар для удаления.
  - `clear(): void` — Очищает корзину, удаляя все товары из массива items.
  - `getTotalPrice(): number` — Считает и возвращает сумму цен всех товаров в корзине. Товары с price === null не учитываются. Общую стоимость товаров в корзине (number).
  - `getProductCount(): number` — Возвращает число товаров(number), находящихся в корзине.
  - `hasProduct(id: string): boolean` — Проверяет наличие товара в корзине по его идентификатору. Параметр id (string) — идентификатор товара.Возвращает true, если товар с указанным id есть в корзине; false — если нет.

#### Класс Customer
Класс `Customer` хранит и управляет данными покупателя, необходимыми для оформления заказа. Обеспечивает валидацию данных перед отправкой на сервер.

Конструктор:
  - `constructor(private events: IEvents)` - `events: IEvents` — система событий приложения. Инициализирует свойство `events`
  - `type TBuyerErrors = Partial<Record<keyof ICustomer, string>>;` — Описывает структуру объекта с сообщениями об ошибках для полей объекта типа `ICustomer`. Используется для валидации данных и отображения пользовательских сообщений об ошибках.

Поля класса:
  - `payment: TPayment | null` — Выбранный способ оплаты;  
  - `email: string` — Адрес электронной почты покупателя.
  - `phone: string` — Контактный номер телефона покупателя.
  - `address: string` — Физичиский адрес покупателя.
  - `events: IEvents` — Экземпляр системы событий для эмита событий;

Методы класса:  
  - `setData(data: Partial<ICustomer>): void` — Обновляет только те поля, которые переданы в объекте data, не затрагивая остальные. Позволяет обновлять данные поэтапно. Параметр data (`Partial<ICustomer>`) — объект с частичными данными покупателя.
  - `getData(): ICustomer` — Возвращает все сохранённые данные покупателя в виде объекта ICustomer.
  - `clearData(): void` — Очищает все данные покупателя, устанавливая поля в пустые или null значения.
  - `validate(): TBuyerErrors | null` — Проверяет все поля на валидность (непустота). Возвращает `TBuyerErrors` с сообщениями об ошибках для невалидных полей. Возвращает null, если все поля валидны;
Пример возвращаемого значения:
  - `typescript`
    `{`
        `payment: 'Не выбран вид оплаты',`
        `email: 'Укажите email'`
    `}`
Означает, что поля payment и email не заполнены, а phone и address валидны.
Правила валидации:
  - `payment`: не null;
  - `email`: не пустая строка;
  - `phone`: не пустая строка;
  - `address`: не пустая строка.

## Слой коммуникации
#### Интерфейс IOrderRequest
Интерфейс `IOrderRequest` описывает структуру данных для запроса на оформление заказа в интернет‑магазине. Включает как сведения о покупателе (наследуемые от ICustomer), способе оплаты, составе заказа и итоговой сумме.

##### Наследование
Расширяет интерфейс `ICustomer`, поэтому содержит все его поля плюс дополнительные.

Поля интерфейса:
  - `payment: TPayment` — Указывает способ оплаты заказа. TPayment (объединённый тип: 'online' | 'cash' | ''). Наследуется от `ICustomer`.
  - `email: string` — Электронная почта покупателя для связи. Ожидается валидный email‑формат (проверка на уровне бизнес‑логики). Наследуется от `ICustomer`.
  - `phone: string` — Контактный телефон покупателя для уведомлений и подтверждения заказа. Наследуется от `ICustomer`.
  - `address: string` — Адрес доставки заказа. Наследуется от `ICustomer`.
  - `total: number` — итоговая сумма заказа в денежных единицах (например, рублях).
  - `items: string[]` — список идентификаторов или названий товаров в заказе.

#### Интерфейс ISubmitAndGetIdTotal
Интерфейс, описывающий ответ от сервера после отправки данных. Содержит идентификатор операции и итоговую сумму.

Поля интерфейса:
  - `id: string` — строковый идентификатор операции.
  - `total: number` — числовое значение итоговой суммы.

### Класс ServerApi
Класс `ServerApi` обеспечивает взаимодействие приложения с серверным API. Использует композицию с базовым классом Api для выполнения HTTP‑запросов. 
Отвечает за:
  получение каталога товаров (GET /product/);
  отправку данных заказа (POST /order/).

  - `constructor(api: Api)`

Поля класса:
  - `api: IApi` — сохранённый экземпляр Api для выполнения запросов.

Методы:
  - `getProducts(): Promise<IProduct[]>` — Выполняет GET‑запрос к эндпоинту /product/, получает каталог товаров и возвращает его(IProduct[]).
  - `sendOrder(orderData: { buyer: IBuyer; items: IProduct[] }): Promise<object>` — Отправляет данные заказа на сервер через POST‑запрос к /order/. Возвращает промис с ответом сервера (тип object).

## Описание классов слоя Представления (View)
### Класс Header
Класс `Header` представляет собой компонент шапки приложения, отвечающий за:
отображение количества товаров в корзине;
 - обработку клика по кнопке корзины;
 - обновление счётчика товаров;
 - сброс счётчика до нуля.
Наследует класс `Component<IHeader>`.

Зависимости:
  - `EventTopic` - Константа, определяющая события. Импортируется из `../../utils/constants`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../utils/utils`.
  - `Component<IHeader>` - Базовый класс для компонентов интерфейса. Импортируется из `../base/Component`.
  - `IEvents` - Интерфейс системы событий для коммуникации между компонентами. Импортируется из `../base/Events`.

Интерфейсы:
  - `IHeader`
    - Свойства:
      - `counter: number` — количество товаров в корзине.

Наследование:
  - Родитель: `Component<IHeader>` - Наследует базовую логику работы с компонентами.
  - Типизирован под `IHeader`.

Конструктор:
  - `constructor(private events: IEvents, container: HTMLElement)` — В конструктор передается `events: IEvents` экземпляр системы событий для коммуникации между компонентами, `container: HTMLElement` — корневой элемент DOM, в котором размещается компонент.

Поля класса:
  - `counterElement: HTMLElement` — Элемент DOM, отображающий количество товаров в корзине. Соответствует селектору `header__basket-counter`.
  - `basketButton: HTMLButtonElement` — Кнопка открытия корзины. Соответствует селектору `header__basket`.

Методы:
  - `set counter(value: number)` - установка значения счётчика товаров в корзине.
    - Параметр:
      - `value: number` — количество товаров (может быть 0).

### Абстрактный базовый класс Card
  - `Card` — абстрактный базовый класс для компонентов карточек товаров. Обеспечивает унифицированное отображение основной информации о товаре: название,цена с валютой. Предназначен для наследования конкретными реализациями карточек (например, для каталога, корзины и т. д.). Наследует класс `Component<IProduct>`.

Используемые интерфейсы и типы:
  - `IProduct` - Интерфейс, описывающий структуру товара. Импортируется из `../../../types`.
  - `CURRENCY`, `PRICE_UNAVAILABLE` - Константы, определяющие валюту для отображения цены, текст для случая когда цена недоступна. Импортируются из `../../../utils/constants`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../../utils/utils`.
  - `Component<IProduct>` - Базовый класс для компонентов интерфейса. Импортируется из `../../base/Component`.

Конструктор:
  - `constructor(container: HTMLElement)` - `container: HTMLElement` — корневой элемент DOM, в котором размещается компонент. Вызывает конструктор базового класса `super(container)`. Инициализирует `titleElement` и `priceElement` с помощью функции `ensureElement`, выполняя поиск элементов внутри `container` по селекторам `card__title` и `card__price` соответственно.

Поля класса:
  - `titleElement: HTMLElement` - Элемент DOM, отображающий название товара. Соответствует селектору `card__title` внутри контейнера компонента.
  - `priceElement: HTMLElement` - Элемент DOM, отображающий цену товара с валютой. Соответствует селектору `card__price` внутри контейнера компонента.
  - `container: HTMLElement` - (унаследовано от `Component`) Корневой элемент DOM, в котором размещается компонент.

Методы:
  - `set title(title: string | '')` - установка названия товара в интерфейсе.
    - Параметры:
      - `title: string | ''` — название товара или пустая строка.
  - `set price(price: number | null)` - установка цены товара с учётом валюты.
    - Параметры:
      - `price: number | null` — цена или null (если недоступна).

### Класс ProductCard
  - `ProductCard` — компонент карточки товара, расширяющий базовый класс Card. Добавляет отображение: категории товара, изображения товара. Поддерживает обработку клика по карточке через переданные действия (открытие детальной страницы товара). Наследует класс `Card`.

Используемые интерфейсы, типы и константы:
  - `ICardActions` - Интерфейс, описывающий доступные действия для карточки (включая обработчик клика onClick) Импортируется из `../../../types`.
  - `categoryMap`- Константа‑объект, содержащий соответствие ключей категорий их текстовым представлениям. Импортируется из `../../../utils/constants`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../../utils/utils`.
  - `Card` - Базовый класс для компонентов карточек товаров. Импортируется из `./cards`.

Конструктор:
  - `constructor(container: HTMLElement, actions?: ICardActions)` - `container: HTMLElement` корневой элемент DOM, в котором размещается компонент. `actions?: ICardActions` объект с действиями для карточки (опционально), в частности, обработчик клика `onClick`.

Поля класса:
  - `categoryElement: HTMLElement` - Элемент DOM, отображающий категорию товара. Соответствует селектору `.card__category` внутри контейнера компонента.
  - `imageElement: HTMLImageElement` - Элемент DOM для отображения изображения товара. Соответствует селектору `.card__image` внутри контейнера компонента.
  - `container: HTMLElement` - (унаследовано от `Card`) Корневой элемент DOM, в котором размещается компонент.
  - `titleElement: HTMLElement`, `priceElement: HTMLElement` (унаследованы от `Card`) Элементы для отображения названия и цены товара соответственно.

Методы:
  - `set category(category: string)` - установка категории товара с визуальной маркировкой.
    - Параметр:
      - `category: string` — название категории (ключ из categoryMap).
  - `set image(imageSrc: string)` - установка изображения товара.
    - Параметр:
      - `imageSrc: string` — URL изображения.
  - `private setImage(imgElement: HTMLImageElement, src: string, altText: string)`  - (private) вспомогательная функция для установки изображения и alt-текста.
    - Параметры:
      - `imgElement: HTMLImageElement` — элемент <img>;
      - `src: string` — URL изображения;
      - `altText: string` — текст для атрибута alt.

### Класс PreviewCard
  - `PreviewCard` — компонент предпросмотра карточки товара, расширяющий `ProductCard`. Добавляет текстовое описание товара, кнопку действия с динамическим текстом и управлением активностью, обработку клика по кнопке для отправки события о выборе товара. Используется для детального отображения товара перед покупкой. Наследует класс `ProductCard`.

Зависимости:
  - `EventTopic` - Константа, определяющая события. Импортируется из `../../../utils/constants`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../../utils/utils`.
  - `IEvents` - Интерфейс системы событий для коммуникации между компонентами. Импортируется из `../../base/Events`.
  - `ProductCard` - Базовый класс для компонентов карточек товаров. Импортируется из `./ProductCard`.

Интерфейсы:
  - `IPreviewCard`
    - Свойства:
      - `description: string` — текстовое описание товара;
      - `isButtonEnabled: boolean` — флаг активности кнопки действия;
      - `textButton: string` — текст на кнопке действия.

Конструктор:
  - `constructor(private event: IEvents, container: HTMLElement)` - `event: IEvents` экземпляр системы событий для коммуникации между компонентами, `container: HTMLElement` корневой элемент DOM, в котором размещается компонент.

Поля класса:
  - `cardButton: HTMLButtonElement` - Элемент DOM, кнопка действия в карточке товара. Соответствует селектору `card__button` внутри контейнера компонента.
  - `cardText: HTMLElement` - Элемент DOM, текстовое описание товара. Соответствует селектору `card__text` внутри контейнера компонента.
  - `event: IEvents` - Экземпляр системы событий для коммуникации между компонентами.
Поля, унаследованные от `ProductCard` - `cardCategoryElement: HTMLElement`, `cardImageElement:HTMLImageElement`, `container: HTMLElement`, `titleElement: HTMLElement`, `priceElement: HTMLElement`.

Методы:
  - `set description(cardDescription: string)` - установка текстового описания товара.
    - Параметр:
      - `cardDescription: string` — описание товара.
  - `set isButtonEnabled(enabled: boolean)` - управление активностью кнопки действия.
    - Параметр:
      - `enabled: boolean` — true для активации, false для отключения.
  - `set textButton(text: string)` - - установка текста на кнопке действия.
    - Параметр:
      - `text: string` — текст для кнопки.

### Класс BasketCard
  - `BasketCard` — компонент карточки товара в корзине, расширяющий базовый класс `Card`. Добавляет порядковый номер товара в корзине, кнопку удаления товара из корзины. Предназначен для отображения товаров в составе корзины покупок. Наследует класс `Card`.

Используемые интерфейсы и типы:
  - `ICardActions` - Интерфейс, описывающий доступные действия для карточки (включая обработчик клика onClick). Импортируется из `../../../types`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../../utils/utils`.
  - `Card` - Базовый класс для компонентов карточек товаров. Импортируется из `./cards`.

Конструктор:
  - `constructor(container: HTMLElement, actions?: ICardActions)` - `container: HTMLElement` корневой элемент DOM, в котором размещается компонент, `actions?: ICardActions` — объект с действиями для карточки (опционально), в частности, обработчик клика `onClick` для кнопки удаления.

Поля класса:
  - `index: HTMLElement` - ссылка на элемент для отображения номера позиции в корзине. Селектор `basket__item-index`.
  - `itemDeleteButton: HTMLButtonElement` - кнопка удаления товара из корзины. Селектор `basket__item-delete`.

Методы:
  - `set indexElement(index: number)` - установка порядкового номера товара в корзине.
    - Параметры:
      - `index: number` — числовой индекс позиции (начиная с 1).

### Класс Gallery
  - `Gallery` — компонент галереи товаров, предназначенный для отображения списка товаров переданный список DOM‑элементов товаров. Наследует класс `Component<IGallery>`.

Зависимости:
  - `IProduct` — интерфейс товара. Импортируется из `../../types`.
  - `Component` — базовый класс компонента. Импортируется из `../base/Component`.

Интерфейсы:
  - `IGallery`
    - Свойства:
      - `productList: IProduct[]` — массив объектов товаров.

Наследование:
  - Родитель: `Component<IGallery>` Наследует базовую логику работы с компонентами;
  - Типизирован под `IGallery`.

Конструктор:
  - `constructor(container: HTMLElement)` - `container: HTMLElement`корневой элемент DOM, в котором размещается компонент.

Методы:
  - `set productList(productList: HTMLElement[])` - установка списка элементов товаров для отображения в галерее.
    - Параметр:
      - `productList: HTMLElement[]` — массив DOM‑элементов карточек товаров.Заменяет все дочерние элементы container на переданный список через `replaceChildren(...productList)`.Если список пуст, контейнер очищается.

### Класс Basket
  - `Basket` — компонент корзины покупок, отображающий список товаров в корзине, общую стоимость заказа, кнопку оформления заказа. Обеспечивает обновление списка товаров, отображение итоговой суммы, управление активностью кнопки оформления заказа, отправку события открытия формы заказа. Наследует класс      `Component<IBasket>`.

Зависимости:
  - `IProduct` - базовый интерфейс товара. Импортируется из `../../types`.
  - `CURRENCY` - Константа, определяющая валюту для отображения цены. Импортируется из `../../utils/constants`.
  - `EventTopic` - Константа, определяющая события (в частности, ORDER_FORM_OPEN). Импортируется из `../../utils/constants`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../utils/utils`.
  - `Component<IBasket>` - Базовый класс для компонентов интерфейса. Импортируется из `../base/Component`.
  - `IEvents` - Интерфейс системы событий для коммуникации между компонентами. Импортируется из `../base/Events`.

Интерфейсы:
  - `IBasket` - Расширяет: `Partial<IProduct>`
    - Свойства:
      - `listProduct: HTMLElement[]` — список DOM‑элементов карточек товаров;
      - `isOrderButtonDisabled: boolean` — флаг активности кнопки оформления заказа;
      - `priceTotal: number` — итоговая сумма заказа.
    - Примечание: интерфейс включает только необходимые поля из `IProduct`.

Наследование:
  - Родитель: `Component<IBasket>` - Наследует базовую логику работы с компонентами;
  - Типизирован под `IBasket`.

Конструктор:
  - `constructor(private events: IEvents, container: HTMLElement)` - `events: IEvents` экземпляр системы событий для коммуникации между компонентами, `container: HTMLElement` корневой элемент DOM, в котором размещается компонент.

Поля класса:
  - `listElement: HTMLElement` - Элемент DOM, содержащий список товаров в корзине. Соответствует селектору `basket__list` внутри контейнера компонента.
  - `buttonElement: HTMLButtonElement` - Элемент DOM кнопка оформления заказа. Соответствует селектору `basket__button` внутри контейнера компонента.
  - `priceElement: HTMLElement` - Элемент DOM, отображающий общую стоимость заказа. Соответствует селектору `basket__price` внутри контейнера компонента.
  - `events: IEvents` - Экземпляр системы событий для коммуникации между компонентами.
  - `container: HTMLElement` (унаследовано от `Component`) Корневой элемент DOM, в котором размещается компонент.

Методы:
  - `set isOrderButtonDisabled(value: boolean)` - управление активностью кнопки оформления заказа.
    - Параметр:
      - `value: boolean` — если `true`, кнопка отключается; если `false`, активируется/ Устанавливает `buttonElement.disabled = value`.
  - `set listProduct(list: HTMLElement[])` - установка списка товаров в корзине.
    - Параметр:
      - `list: HTMLElement[]` — массив DOM‑элементов карточек товаров. Заменяет все дочерние элементы `listElement` на переданный список через `replaceChildren(...list)`. Если список пуст, контейнер очищается.
  - `set priceTotal(price: number)` - установка итоговой суммы заказа с валютой.

### Класс Modal
  - `Modal` — компонент модального окна, обеспечивающий отображение произвольного содержимого, закрытие по клику на кнопку закрытия, закрытие по клику на затемнённую область вокруг содержимого, управление видимостью окна (открытие/закрытие). Наследует класс `Component<IModal>`.

Используемые интерфейсы, типы и утилиты:
  - `IModal` - Интерфейс, описывающий данные для компонента `Modal`. Содержит поле `content` (элемент DOM с содержимым окна).
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../utils/utils`.
  - `Component<IModal>` - Базовый класс для компонентов интерфейса. Импортируется из `../base/Component`.
  - `IEvents` - Интерфейс системы событий для коммуникации между компонентами. Импортируется из `../base/Events`.

Конструктор:
  - `constructor(private event: IEvents, container: HTMLElement)` - `event: IEvents` экземпляр системы событий для коммуникации между компонентами, `container: HTMLElement` корневой элемент DOM, в котором размещается компонент.

Поля класса:
  - `closeButtonElement: HTMLButtonElement` - Элемент DOM кнопка закрытия модального окна. Соответствует селектору `modal__close` внутри контейнера компонента.
  - `content: HTMLElement` - Элемент DOM, в который вставляется содержимое модального окна. Соответствует селектору `modal__content` внутри контейнера компонента.
  - `event: IEvents` - Экземпляр системы событий для коммуникации между компонентами
  - `container: HTMLElement` -  (унаследовано от `Component`) Корневой элемент DOM, в котором размещается компонент.

Методы:
  - `emitCloseModal(): void`(private) - Отправляет событие о закрытии модального окна через систему событий.
  - `open(content: HTMLElement): void` - Открывает модальное окно и вставляет указанное содержимое. `content: HTMLElement` элемент DOM, который будет отображён внутри модального окна.
  - `close(): void` - Закрывает модальное окно.

### Абстрактный базовый класс Form
  - `Form` — абстрактный базовый класс для форм, обеспечивающий управление активностью кнопки отправки, отображение сообщений об ошибках, базовую логику отрисовки формы. Предназначен для наследования конкретными реализациями форм. Наследует класс `Component<IFormError>`.

Зависимости:
  - `ICustomer` — базовый интерфейс данных покупателя.  Импортируется из `../../types`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../../utils/utils`.
  - `Component<IFormError>` - Базовый класс для компонентов интерфейса. Импортируется из `../../base/Component`.

Интерфейсы:
  - `IForm` - Расширяет `ICustomer`
    - Свойства:
      - `toggleSubmitButton: string` — флаг для управления кнопкой отправки (не используется напрямую как строка);
      - `messageError: string` — сообщение об ошибке для отображения.
    - Примечание: поля `toggleSubmitButton` и `messageError` в интерфейсе формально присутствуют, но фактически управляются через сеттеры класса.

Наследование:
  - Родитель: `Component<IForm>`
  - Типизирован под интерфейс `IForm` обеспечивает базовую работу с DOM.

Конструктор:
  - `constructor(container: HTMLElement)` - `container: HTMLElement` корневой элемент DOM, в котором размещается форма.

Поля класса
  - `submitButtonElement: HTMLButtonElement` - Элемент DOM кнопка отправки формы. Соответствует селектору `button[type="submit"]` внутри контейнера компонента.
  - `formErrorsElement: HTMLElement` - Элемент DOM, отображающий сообщения об ошибках формы. Соответствует селектору `form__errors` внутри контейнера компонента.
  - `container: HTMLElement` - (унаследовано от `Component`) Корневой элемент DOM, в котором размещается компонент.

Методы:
  - `set toggleSubmitButton(isEnabled: boolean)` - управление активностью кнопки отправки.
    - Параметр:
      - `isEnabled: boolean` — если `true`, кнопка отключается (`disabled = true`); если `false` — активируется.
  - `set messageError(message: string)` - установка сообщения об ошибке.
    - Параметр:
      - `message: string` — текст ошибки (может быть пустым).

### Класс OrderForm
  - `OrderForm` — компонент формы заказа, расширяющий базовый класс `Form`. Обеспечивает выбор способа оплаты (онлайн/наличными), ввод адреса доставки, отправку данных формы ,визуальное выделение выбранного способа оплаты, обработку изменений полей и отправку событий. Наследует класс `Form`.

Зависимости:
  - `TPayment` — тип данных способа оплаты. Импортируется из `../../types`
  - `EventTopic` - Константа, определяющая события. Импортируется из `../../../utils/constants`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../../utils/utils`.
  - `IEvents` - Интерфейс системы событий для коммуникации между компонентами. Импортируется из `../../base/Events`.
  - `Form` - Базовый класс для форм. Импортируется из `./Form`.

Интерфейсы:
  - `IOrderForm`
    - Свойства:
      - `payment: TPayment` — выбранный способ оплаты;
      - `address: string` — адрес доставки.
    - Примечание: интерфейс не включает `messageError` напрямую, но структура совместима с `IForm` через наследование класса.

Наследование:
  - Родитель: `Form` - Наследует логику управления кнопкой отправки и сообщениями об ошибках;
  - Типизирован под `IOrderForm`.

Конструктор
  - `constructor(private events: IEvents, container: HTMLElement)` - `events: IEvents` экземпляр системы событий для коммуникации между компонентами, `container: HTMLElement` корневой элемент DOM, в котором размещается форма.

Поля класса:
  - `buttonsNodes: HTMLButtonElement[]` - список кнопок оплаты. Селектор `button_alt` внутри `order__buttons`.
  - `addressElement: HTMLInputElement`- Элемент DOM поле ввода адреса доставки. Соответствует селектору `input[name="address"]` внутри контейнера формы.
  - `events: IEvents` - Экземпляр системы событий для коммуникации между компонентами
Поля, унаследованные от Form: `submitButtonElement: HTMLButtonElement`, `formErrorsElement: HTMLElement`,`container: HTMLElement`.

Методы:
  - `set payment(value: TPayment)` - установка выбранного способа оплаты и визуальная индикация.
    - Параметр:
      - `value: TPayment` — значение способа оплаты. Для каждой кнопки в `buttonsNodes`: если `button.name === value`, добавляет класс `button_alt-active` иначе удаляет класс `button_alt-active`.
  - `set address(address: string)` - установка значения поля адреса доставки.
    - Параметр:
      - `address: string` — строка с адресом.

### Класс ContactsForm
  - `ContactsForm` — компонент формы контактов, расширяющий базовый класс `Form`. Обеспечивает ввод email и номера телефона, отправку данных формы,обработку изменений полей и отправку событий при вводе, восстановление значений полей из переданных данных. Наследует класс `Form<IContactsForm>`.

Зависимости:
  - `EventTopic` - Константа, определяющая события. Импортируется из `../../../utils/constants`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../../utils/utils`.
  - `IEvents` - Интерфейс системы событий для коммуникации между компонентами. Импортируется из `../../base/Events`.
  - `Form` - Базовый класс для форм. Импортируется из `./Form`.

Интерфейсы:
  - `IContactsForm`
    - Свойства:
      - `email: string` — email‑адрес;
      - `phone: string` — номер телефона;
      - `messageError: string` — сообщение об ошибке (унаследовано от `IForm`).

Наследование:
  - Родитель: `Form` - Наследует логику управления кнопкой отправки и сообщениями об ошибках;
  - Примечание: IContactsForm не расширяет IForm напрямую, но структура данных совместима благодаря наследованию класса.
  - Типизирован под `IContactsForm`.
  
Конструктор:
  - `constructor(private events: IEvents, container: HTMLElement)` - `events: IEvents` экземпляр системы событий для коммуникации между компонентами, `container: HTMLElement` корневой элемент DOM, в котором размещается форма.

Поля класса:
  - `emailElement: HTMLInputElement` - Элемент DOM поле ввода email. Соответствует селектору `input[name="email"]` внутри контейнера формы.
  - `phoneElement: HTMLInputElement` - Элемент DOM поле ввода номера телефона. Соответствует селектору `input[name="phone"]` внутри контейнера формы.
  - `events: IEvents` - Экземпляр системы событий для коммуникации между компонентами.
Поля, унаследованные от `Form` - `submitButtonElement: HTMLButtonElement`, `formErrorsElement: HTMLElement`, `container: HTMLElement`.

Методы:
  - `set email(email: string)` - установка значения поля email.
    - Параметр:
      - `email: string` — email‑адрес.
  - `set phone(phone: string)` - установка значения поля телефона.
    - Параметр:
      - `phone: string` — номер телефона.

### Класс SuccessForm
  - `SuccessForm` — компонент успешного завершения заказа, отображающий сообщение об успешном оформлении заказа, возможность закрытия модального окна при клике. Предназначен для информирования пользователя о завершении процесса заказа. Наследует класс `Component<ISuccess>`.

Зависимости:
  - `EventTopic` - Константа, определяющая события. Импортируется из `../../../utils/constants`.
  - `ensureElement` - Утилитарная функция для поиска и проверки DOM‑элементов. Импортируется из `../../../utils/utils`.
  - `Component<ISuccess>` - Базовый класс для компонентов интерфейса. Импортируется из `../../base/Component`.
  - `IEvents` - Интерфейс системы событий для коммуникации между компонентами. Импортируется из `../../base/Events`.

Интерфейсы:
  - `ISuccess`
    - Свойства:
      - `description: string` — текстовое описание результата заказа.

Наследование:
  - Родитель: `Component<ISuccess>` - Наследует базовую логику работы с компонентами;
  - Типизирован под `ISuccess`.

Конструктор:
  - `constructor(protected events: IEvents, container: HTMLElement)` - `events: IEvents` экземпляр системы событий для коммуникации между компонентами, `container: HTMLElement` корневой элемент DOM, в котором размещается компонент.

Поля класса:
  - `descriptionElement: HTMLElement` - Элемент DOM, отображающий описание успеха. Соответствует селектору `order-success__description` внутри контейнера компонента.
  - `events: IEvents` - Экземпляр системы событий для коммуникации между компонентами
  - `container: HTMLElement` - (унаследовано от Component) Корневой элемент DOM, в котором размещается компонент

Методы:
  - `set description(description: string)` - установка текстового описания результата заказа.
    - Параметр:
      - `description: string` — текст описания.

## События Event
  - Используется для унификации событий в системе событий (брокере сообщений).

### Работа с товаром
  - `PRODUCT_RECEIVED` ('`product:received`') — изменение каталога товаров.
  - `PRODUCT_SELECT_CARD` ('`product:selectCard`') — выбор карточки товара.
  - `PRODUCT_SELECTED` ('`product:selected`') — открытие карточки товара для просмотра.
  - `PRODUCT_SUBMIT` ('`product:submit`') — добавление/удаление товара в корзине.

### Корзина
  - `BASKET_OPEN` ('`basket:open`') — открытие корзины.
  - `BASKET_PRODUCT_REMOVE` ('`basket:productRemove`') — удаление товара из корзины.
  - `BASKET_LIST_UPDATE` ('`basket:listUpdate`') — обновление списка товаров в корзине.
  - `CUSTOMER_RECEIVED` = ('`customer:received`') — изменение данных пользователя.

### Формы 
  - `FORM_VALIDATION` ('`form:validation`') — Событие водидации форм.
  - `FORM_PAYMENT_SELECT` ('`form:paymentSelect`') — Событие выбора способа оплаты.
  - `FORM_ADDRESS_INPUT` ('`form:addressInput`') — ввод адреса доставки.
  - `FORM_EMAIL_INPUT` ('`form:emailInput`') — ввод email.
  - `FORM_PHONE_INPUT` ('`form:phoneInput`') — ввод телефона.
  
  - `ORDER_FORM_OPEN` ('`orderForm:open`') — открытие формы.
  - `ORDER_FORM_SUBMIT` ('`orderForm:submit`') — отправка формы заказа.
  
  - `CONTACT_FORM_SUBMIT` ('`contactForm:submit`') — отправка формы контактов.

  - `MODAL_CLOSE` ('`modal:close`') — закрытие модального окна.
  - `SUCCESS_MODAL_CLOSE` ('`successModal:close`') — закрытие модального окна с подтверждением успеха после отправки формы.

## Константы

### Константы стоимости и валюты
  - `CURRENCY` - обозначение денежной единицы. Использование: отображается в интерфейсе (например, «100 синапсов»).
  - `PRICE_UNAVAILABLE` - текст для товаров с отсутствующей ценой (null). Использование: отображается вместо цены в карточке товара.

### Константы для текста кнопок
  - `BUTTON_TEXT_UNAVAILABLE` = 'Недоступно' - текст кнопки для товара с null в цене. Использование: в карточке товара вместо кнопки «Купить».
  - `BUTTON_TEXT_BUY` = 'Купить' - текст кнопки добавления товара в корзину. Использование: в карточке товара, если товар доступен.
  - `BUTTON_TEXT_REMOVE` = 'Удалить из корзины' - текст кнопки удаления товара из корзины. Использование: в карточке товара, для удаления товара из корзины.

## Презентер
  Данный код представляет собой основной модуль приложения, который инициализирует все ключевые компоненты и сервисы, устанавливает связи между моделями, представлениями и сервисами, настраивает обработку событий через централизованный `EventEmitter`.

### Структура и ключевые блоки
#### Импорты
Подклчаются:
 - стили (scss);
 - базовые классы (Api, EventEmitter);
 - сервисы (ApiService);
 - модели (ProductCatalog, ShoppingCart, Customer);
 - представления (Modal, Header, Gallery, Basket);
 - карточки и формы (ProductCard, PreviewCard, BasketCard, OrderForm, ContactsForm, SuccessForm);
 - менеджер заказов (OrderManager);
 - константы, типы и утилиты.

#### Получение DOM‑элементов
Определяются корневые элементы интерфейса:
  - `page` — основная страница;
  - `headerView` — шапка;
  - `galleryView` — галерея товаров;
  - `modalView` — модальное окно.

#### Инициализация сервисов и системы событий
  - `api` — экземпляр API с базовым URL;
  - `apiService` — сервис для работы с API;
  - `eventEmitter` — централизованный эмиттер событий.

#### Создание представлений (views)
  - `gallery` — отображение списка товаров;
  - `modal` — модальное окно для диалогов;
  - `header` — шапка с счётчиком корзины.

#### Создание моделей данных
  - `productsModel` — каталог товаров;
  - `shoppingCart` — корзина покупок;
  - `customer` — данные покупателя.

#### Создание карточек и форм
  - `previewCard` — предпросмотр товара;
  - `basket` — корзина;
  - `orderForm` — форма заказа (способ оплаты, адрес);
  - `contactsForm` — форма контактов (email, телефон);
  - `successForm` — сообщение об успехе.

### Обработка событий (EventEmitter)
  - Основная логика строится на событийной модели. Ниже — ключевые события и их обработка.

#### PRODUCT_RECEIVED ('`product:received`') — изменение каталога товаров.
  - Загружает список товаров из `productsModel`.
  - Создаёт карточки `ProductCard` для каждого товара.
  - Передаёт данные в gallery для отображения.

#### PRODUCT_SELECT_CARD ('`product:selectCard`') — выбор карточки товара.
  - Получает выбранный товар по ID.
  - Определяет текст кнопки (BUY / REMOVE / UNAVAILABLE).
  - Отображает предпросмотр в previewCard.
  - Сохраняет выбранный товар в `productsModel`.

#### PRODUCT_SELECTED ('`product:selected`') — открытие карточки товара для просмотра.
  - Открывает предпросмотр товара в модальном окне.
  - Определяет текст кнопки («Купить», «Удалить», «Недоступно»).

#### PRODUCT_SUBMIT ('`product:submit`') — добавление/удаление товара в корзине.
  - Добавляет/удаляет товар в корзине.
  - Обновляет счётчик в шапке.
  - Закрывает модальное окно.

#### BASKET_LIST_UPDATE ('`basket:listUpdate`') — обновление списка товаров в корзине.
  - Формирует список карточек BasketCard для товаров в корзине.
  - Передаёт данные в basket (включая общую сумму).

#### BASKET_OPEN ('`basket:order`') — оформление заказа из корзины.
  - Открывает модальное окно с корзиной.

#### BASKET_PRODUCT_REMOVE ('`basket:productRemove`') — удаление товара из корзины.
  - Удаляет товар из корзины.
  - Обновляет счётчик и общую сумму.
  - Активирует/деактивирует кнопку заказа в зависимости от наличия товаров.

#### ORDER_FORM_OPEN ('`orderForm:open`') — открытие формы.
  - Открывает форму заказа с текущими данными клиента.

#### FORM_ADDRESS_INPUT ('`form:addressInput`') — ввод адреса доставки.
  - Сохраняет введённый адрес в модели клиента.

#### FORM_PAYMENT_SELECT ('`form:paymentSelect`') выбор способа оплаты онлайн.
  - Устанавливает выбранный способ оплаты в форме и модели.

#### ORDER_FORM_SUBMIT ('`orderForm:submit`') — отправка формы заказа.
  - Предотвращает отправку формы.
  - Открывает форму контактов.
  - Разрешает отправку формы контактов.

#### FORM_VALIDATION ('`form:validation`') — валидации данных форм.
  - Валидирует поля формы заказа (адрес, способ оплаты).
  - Показывает ошибки, блокирует кнопку отправки при ошибках.

#### FORM_EMAIL_INPUT ('`form:emailInput`') — ввод email.
  - Сохраняет введённые email в модели клиента.

#### FORM_PHONE_INPUT ('`form:phoneInput`') — ввод телефона.
  - Сохраняет введённые телефон в модели клиента.

#### CONTACT_FORM_SUBMIT ('`contactForm:submit`') — отправка формы контактов.
  - Предотвращает отправку формы.
  - Запускает отправку заказа через orderManager.submitOrder().

#### SUCCESS_MODAL_CLOSE ('`successModal:close`') — закрытие модального окна.
  - Закрывает модальное окно после успеха.

#### MODAL_CLOSE ('`modal:close`') — закрытие модального окна.
  - Общее событие для закрытия модального окна.

### Ключевые процессы
#### Загрузка товаров
  - apiService.getProducts() → productsModel.setProductList() → событие PRODUCT_RECEIVED → отображение в gallery.

#### Выбор товара
  - Клик по карточке → PRODUCT_SELECT_CARD → сохранение в модели → PRODUCT_SELECTED → предпросмотр в модальном окне.

#### Работа с корзиной
  - Добавление/удаление товара → PRODUCT_SUBMIT → обновление корзины и счётчика.
  - Открытие корзины → BASKET_OPEN → отображение списка и суммы.

#### Оформление заказа
  - Открытие формы заказа → ввод данных → валидация → переход к форме контактов → валидация → отправка заказа через orderManager.

#### Успешная отправка
  - orderManager.handleSuccess() → открытие successForm → очистка корзины и данных → обнуление счётчика.

### Зависимости и связи
  - Модели (`ProductCatalog`, `ShoppingCart`, `Customer`) хранят данные и транслируют события при изменениях.
  - Представления (`Gallery`, `Modal`, `Header`, `Basket`) отображают данные и генерируют события.
  - Формы (`OrderForm`, `ContactsForm`, `SuccessForm`) собирают данные и транслируют события.
  - Сервисы (`ApiService`) выполняют бизнес‑логику (запрос API, отправка заказа).
  - `EventEmitter` связывает все компоненты, обеспечивая слабую связность.